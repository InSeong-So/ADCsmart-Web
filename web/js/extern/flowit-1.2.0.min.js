var FlowitUtil={};
FlowitUtil.log=function()
{
	try
	{
//		console.log.apply(console,arguments);
	}
	catch(e)
	{
	}
};

FlowitUtil.getHTML=function(d)
{
	var e=$.extend({target:"",
					url:"",
					data:"",
					successFn:"",
					completeFn:"",
					async:true,
					type:"POST",
					traditional:true,
					params:""},
					d);
	if(e.target=="")
		return;
	if(e.url=="")
		return;
	$.ajax({url:e.url,
			dataType:"html",
			async:e.async,
			data:e.data,
			type:e.type,
			traditional:e.traditional,
			success:function(a){
				$(e.target).html(a);
				if(e.successFn!="")
					e.successFn(e.params);
			},
			error:function(jqXhr, status, message){
				ajaxExceptionMessage(jqXhr, status, message);
			},
			complete:function(a,b){
				if(e.completeFn!="")
					e.completeFn(b);
			}
	});
};

FlowitUtil.getJSON=function(d)
{
	var e=$.extend({target:"",
					url:"",
					data:"",
					successFn:"",
					completeFn:"",
					async:true,
					type:"POST",
					traditional:true},
					d);
	if(e.url=="")
		return;
	$.ajax({type:"POST",
			async:e.async,
			url:e.url,
			data:e.data,
			type:e.type,
			traditional:e.traditional,
			dataType:"json",
			success:function(a)
			{
				if(e.successFn!="")
					e.successFn(a);
			},
			error:function(jqXhr, status, message)
			{
				ajaxExceptionMessage(jqXhr, status, message);
			},
			complete:function(a,b)
			{
				if(e.completeFn!="")
					e.completeFn(b);
			}
	});
};

FlowitUtil.checkPassword=function(a)
{
//	var b=/^(?=.{8,16})(?=.*[a-zA-Z])(?=.*[!@#$%^&\*\(\)\-_\+=~`\[\{\]\}\|\\;:'"\<,\>\.\?\/])(?=.*[0-9]).*$/g;
	var b=/^(?=.{5,16})(?=.*[a-zA-Z])(?=.*[0-9]).*$/g;//알파벳과 숫자 조합의 5~16자 사이로 구성..
//	var b=/^(?=.{8,16})(?=.*[a-zA-Z])(?=.*[^!@#$%^&\*\(\)\-_\+=~`\[\{\]\}\|\\;:'"\<,\>\.\?\/])(?=.*[0-9]).*$/g;
	return b.test(a);
};

FlowitUtil.checkUserID=function(a)
{
//	var b=/^(?=.{8,16})(?=.*[a-zA-Z])(?=.*[!@#$%^&\*\(\)\-_\+=~`\[\{\]\}\|\\;:'"\<,\>\.\?\/])(?=.*[0-9]).*$/g;
	var b=/^[a-zA-Z][a-zA-Z0-9]{4,15}$/g;//알파벳으로 시작하고 알파벳과 숫자 조합의 5~16자 사이로 구성..
//	var b=/^(?=.{8,16})(?=.*[a-zA-Z])(?=.*[^!@#$%^&\*\(\)\-_\+=~`\[\{\]\}\|\\;:'"\<,\>\.\?\/])(?=.*[0-9]).*$/g;
	return b.test(a);
};

FlowitUtil.checkIp=function(a)
{
	var b=/^((25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/;
	return b.test(a);
};

FlowitUtil.checkNum=function(a)
{
	var b=/[^0-9]/;
	return b.test(a);
};

FlowitUtil.isNumeric=function(input)
{
	return (input-0)==input && (''+input).replace(/^\s+|\s+$/g, "").length > 0;
};

// 0~65535 사이의 값이 아니면 return true
FlowitUtil.checkPortNum=function(a)
{
	if(FlowitUtil.isNumeric(a)==false)
		return false;
//	var b=/[^0-9]/;
//	var retVal = b.test(a);
//	if(retVal==true)
//	{
//		alert("bbbb:"+a);
//		return true;
//	}
//	else
	{
		if(a>=0 && a<=65535)
			return true;
		return false;
	}
};

//min~max 사이의 값이 아니면 return true
FlowitUtil.isValidNum=function(value, min, max)
{
	var b=/[^0-9]/;
	var retVal = b.test(value);
	if(retVal==true)
	{
		return false;
	}
	else
	{
		if(value<min || value>max)
		{
			return false;
		}
		return true;
	}
};

FlowitUtil.checkEmail=function(a)
{
	var b=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i;
	return b.test(a);
};

FlowitUtil.cutString=function(a,b)
{
	if(a==null||a=="")
		return"";
	var c=0;
	var d=0;
	var e="";
	var f=a.length;
	for(var i=0;i<f;i++)
	{
		var g=a.charAt(i);
		if(escape(g).length>4)
		{
			c=2;
		}
		else if(g=="\n")
		{
			if(a.charAt(i-1)!="\n")
			{
				c=1;
			}
		}
		else if(g=="<"||g==">")
		{
			c=4;
		}
		else
		{
			c=1;
		}
		
		if((d+c)>b)
		{
			e+=" ... ";
			break;
		}
		d+=c;
		e+=g;
	};
	return e;
};

var Class=(function()
{
	var e=(function()
		{
			for(var p in{toString:1})
			{
				if(p==='toString')
					return false;
			}
			return true;
		})();
	function subclass(){};
	function create()
	{
		var a=null,properties=$A(arguments);
		if(Object.isFunction(properties[0]))
			a=properties.shift();
		function klass()
		{
			this.initialize.apply(this,arguments);
		}
		Object.extend(klass,Class.Methods);
		klass.superclass=a;
		klass.subclasses=[];
		if(a)
		{
			subclass.prototype=a.prototype;
			klass.prototype=new subclass;
			a.subclasses.push(klass);
		}
		for(var i=0,length=properties.length;i<length;i++)
			klass.addMethods(properties[i]);
		if(!klass.prototype.initialize)
			klass.prototype.initialize=Prototype.emptyFunction;
		klass.prototype.constructor=klass;
		return klass;
	}
	function addMethods(a)
	{
		var b=this.superclass&&this.superclass.prototype,properties=Object.keys(a);
		if(e)
		{
			if(a.toString!=Object.prototype.toString)
				properties.push("toString");
			if(a.valueOf!=Object.prototype.valueOf)
				properties.push("valueOf");
		}
		for(var i=0,length=properties.length;i<length;i++)
		{
			var c=properties[i],value=a[c];
			if(b&&Object.isFunction(value)&&value.argumentNames()[0]=="$super")
			{
				var d=value;
				value=(function(m)
						{
							return function()
									{
										return b[m].apply(this,arguments);
									};
						})(c).wrap(d);
				value.valueOf=d.valueOf.bind(d);
				value.toString=d.toString.bind(d);
			}
			this.prototype[c]=value;
		}
		return this;
	}
	return{create:create,Methods:{addMethods:addMethods}};
})();

(function()
{
	var j=Object.prototype.toString,NULL_TYPE='Null',UNDEFINED_TYPE='Undefined',BOOLEAN_TYPE='Boolean',NUMBER_TYPE='Number',STRING_TYPE='String',OBJECT_TYPE='Object',FUNCTION_CLASS='[object Function]',BOOLEAN_CLASS='[object Boolean]',NUMBER_CLASS='[object Number]',STRING_CLASS='[object String]',ARRAY_CLASS='[object Array]',DATE_CLASS='[object Date]',NATIVE_JSON_STRINGIFY_SUPPORT=window.JSON&&typeof JSON.stringify==='function'&&JSON.stringify(0)==='0';
	function Type(o)
	{
		switch(o)
		{
		case null:
			return NULL_TYPE;
		case(void 0):
			return UNDEFINED_TYPE;
		}
		var a=typeof o;
		switch(a)
		{
		case'boolean':
			return BOOLEAN_TYPE;
		case'number':
			return NUMBER_TYPE;
		case'string':
			return STRING_TYPE;
		}
		return OBJECT_TYPE;
	}
	function extend(a,b)
	{
		for(var c in b)
			a[c]=b[c];
		return a;
	}
	function inspect(a)
	{
		try
		{
			if(isUndefined(a))
				return'undefined';
			if(a===null)
				return'null';
			return a.inspect?a.inspect():String(a);
		}
		catch(e)
		{
			if(e instanceof RangeError)
				return'...';
			throw e;
		}
	}
	function toJSON(a)
	{
		return Str('',{'':a},[]);
	}
	function Str(a,b,c)
	{
		var d=b[a],type=typeof d;
		if(Type(d)===OBJECT_TYPE&&typeof d.toJSON==='function')
		{
			d=d.toJSON(a);
		}
		var e=j.call(d);
		switch(e)
		{
		case NUMBER_CLASS:
		case BOOLEAN_CLASS:
		case STRING_CLASS:
			d=d.valueOf();
		}
		switch(d)
		{
		case null:
			return'null';
		case true:
			return'true';
		case false:
			return'false';
		}
		type=typeof d;
		switch(type)
		{
		case'string':
			return d.inspect(true);
		case'number':
			return isFinite(d)?String(d):'null';
		case'object':
			for(var i=0,length=c.length;i<length;i++)
			{
				if(c[i]===d)
				{
					throw new TypeError();
				}
			}
			c.push(d);
			var f=[];
			if(e===ARRAY_CLASS)
			{
				for(var i=0,length=d.length;i<length;i++)
				{
					var g=Str(i,d,c);
					f.push(typeof g==='undefined'?'null':g);
				}
				f='['+f.join(',')+']';
			}
			else
			{
				var h=Object.keys(d);
				for(var i=0,length=h.length;i<length;i++)
				{
					var a=h[i],g=Str(a,d,c);
					if(typeof g!=="undefined")
					{
						f.push(a.inspect(true)+':'+g);
					}
				}
				f='{'+f.join(',')+'}';
			}
			c.pop();
			return f;
		}
	}
	function stringify(a)
	{
		return JSON.stringify(a);
	}
	function toQueryString(a)
	{
		return $H(a).toQueryString();
	}
	function toHTML(a)
	{
		return a&&a.toHTML?a.toHTML():String.interpret(a);
	}
	function keys(a)
	{
		if(Type(a)!==OBJECT_TYPE)
		{
			throw new TypeError();
		}
		var b=[];
		for(var c in a)
		{
			if(a.hasOwnProperty(c))
			{
				b.push(c);
			}
		}
		return b;
	}
	function values(a)
	{
		var b=[];
		for(var c in a)
			b.push(a[c]);
		return b;
	}
	function clone(a)
	{
		return extend({},a);
	}
	function isElement(a)
	{
		return!!(a&&a.nodeType==1);
	}
	function isArray(a)
	{
		return j.call(a)===ARRAY_CLASS;
	}
	var k=(typeof Array.isArray=='function')&&Array.isArray([])&&!Array.isArray({});
	if(k)
	{
		isArray=Array.isArray;
	}
	function isHash(a)
	{
		return a instanceof hash;
	}
	function isFunction(a)
	{
		return j.call(a)===FUNCTION_CLASS;
	}
	function isString(a)
	{
		return j.call(a)===STRING_CLASS;
	}
	function isNumber(a)
	{
		return j.call(a)===NUMBER_CLASS;
	}
	function isDate(a)
	{
		return j.call(a)===DATE_CLASS;
	}
	function isUndefined(a)
	{
		return typeof a==="undefined";
	}
	extend(Object,{extend:extend,
					inspect:inspect,
					toJSON:NATIVE_JSON_STRINGIFY_SUPPORT?stringify:toJSON,
					toQueryString:toQueryString,
					toHTML:toHTML,
					keys:Object.keys||keys,
					values:values,
					clone:clone,
					isElement:isElement,
					isArray:isArray,
					isHash:isHash,
					isFunction:isFunction,
					isString:isString,
					isNumber:isNumber,
					isDate:isDate,
					isUndefined:isUndefined
					});
})();

function $A(a)
{
	if(!a)
		return[];
	if('toArray'in Object(a))
		return a.toArray();
	var b=a.length||0,results=new Array(b);
	while(b--)
		results[b]=a[b];
	return results;
}

var dateFormat=function()
{
	var g=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g;
	var pad=function(a,b)
	{
		a=String(a);
		b=b||2;
		while(a.length<b)
			a="0"+a;
		return a;
	};
	return function(b,c,e)
	{
		var f=dateFormat;
		if(arguments.length==1&&Object.prototype.toString.call(b)=="[object String]"&&!/\d/.test(b))
		{
			c=b;b=undefined;
		}
		b=b?new Date(b):new Date;
		if(isNaN(b))
			throw SyntaxError("invalid date");
		c=String(f.masks[c]||c||f.masks["default"]);
		if(c.slice(0,4)=="UTC:")
		{
			c=c.slice(4);
			e=true;
		}
		var _=e?"getUTC":"get",d=b[_+"Date"](),D=b[_+"Day"](),m=b[_+"Month"](),y=b[_+"FullYear"](),H=b[_+"Hours"](),M=b[_+"Minutes"](),s=b[_+"Seconds"](),L=b[_+"Milliseconds"](),o=e?0:b.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:f.i18n.dayNames[D],dddd:f.i18n.dayNames[D+7],m:m+1,mm:pad(m+1),mmm:f.i18n.monthNames[m],mmmm:f.i18n.monthNames[m+12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:H<12?"a":"p",tt:H<12?"am":"pm",T:H<12?"A":"P",TT:H<12?"AM":"PM",Z:e?"UTC":(String(b).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+pad(Math.floor(Math.abs(o)/60)*100+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};
		return c.replace(g,function(a)
							{
								return a in flags?flags[a]:a.slice(1,a.length-1);
							}
						);
	};
}();

dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};
Date.prototype.format=function(a,b)
{
	return dateFormat(this,a,b);
};

var FlowitTaskQ=Class.create(
{
	initialize:function()
	{
		this.TIMER_DELAY=200;
		this.timerId=0;
		this.startedTask=false;
		this.task=null;
		this.tasks=[];
	},
	add:function(a)
	{
		FlowitUtil.log("Add a task.");
		var b=this.tasks.push(a);
		FlowitUtil.log("size of tasks: %s",b);
	},
	start:function(a)
	{
		FlowitUtil.log("start tasks.");
		with(this)
		{
			FlowitUtil.log("timerId: %s, task: %s, tasks: %s",timerId,task,tasks);
			if(timerId||tasks.length===0)
				return;
			(function()
			{
				FlowitUtil.log("timing event at %s",new Date().getTime());
				FlowitUtil.log("timerId: %s, startedTask: %s, task: %s, tasks: %s",timerId,startedTask,task,tasks);
				if(!task&&tasks.length===0)
				{
					FlowitUtil.log("All tasks done!");
					timerId=0;
					return;
				}
				else if(!task&&tasks.length>0)
				{
					task=tasks.shift();
					startedTask=false;
					FlowitUtil.log("A new task is assigned; %s",task);
					if(!a)
						_runTask();
				}
				else if(task&&!startedTask)
					_runTask();
				timerId=setTimeout(arguments.callee,TIMER_DELAY);
				FlowitUtil.log("next timing event set to %s",timerId);
			})();
		}
	},
	stop:function()
	{
		FlowitUtil.log("stop tasks.");
		if(this.timerId)
		{
			clearTimeout(this.timerId);
			this.timerId=0;
		}
	},
	notifyTaskDone:function()
	{
		FlowitUtil.log("A task done notified.");
		this.task=null;
	},
	_runTask:function()
	{
		with(this)
		{
			FlowitUtil.log("The task has started; %s",task);
			task();
			startedTask=true;
			FlowitUtil.log("The task has finished; %s",task);
		}
	}
});

var FlowitAjax=Class.create(	// nimbleLoader 가 구현된 AjaxManager
{
	initialize:function()
	{
		var d=this;
		this.singleAjax=$.manageAjax.create('singleQueue',{queue:true});
		this.idsInQueue=[];
		this._initLoadingBar();
		$(document).bind('singleQueueAjaxStart',function(e)
		{
			FlowitUtil.log('singleQueueAjaxStart:');
			d._showLoader(true);
		});
		$(document).bind('singleQueueAjaxStop',function(e)
		{
			FlowitUtil.log('singleQueueAjaxStop:');
			d._showLoader(false);
		});
		$(document).bind('singleQueueAjaxComplete',function(e,a,b,c)
		{
			FlowitUtil.log('singleQueueAjaxComplete:');
			FlowitUtil.log('status: '+b);
			d._removeId(c.xhrID);
		});
	},
	isRunning:function()
	{
		with(this)
		{
			if(idsInQueue.length>0)
				return true;
			return false;
		}
	},
	abort:function()
	{
		this.singleAjax.abort();
	},
	runIfIdle:function(a)
	{
		with(this)
		{
			if(idsInQueue.length>0)
			{
				$.obAlertNotice(VAR_ETC_TASKRUN);
				return;
			}
			_addId(singleAjax.add(a));
		}
	},
	run:function(a)
	{
		with(this)
		{
			FlowitUtil.log("run()");
			_addId(singleAjax.add(a));
		}
	},
	runHtml:function(d,e)
	{
		with(this)
		{
			var f=$.extend({target:"",
							url:"",
							data:"",
							successFn:"",
							completeFn:"",
							type:"POST",
							traditional:true,
							params:""},
							d);
			if(f.target=="")
				return;
			if(f.url=="")
				return;
			run({url:f.url,
				dataType:"html",
				data:f.data,
				type:f.type,
				traditional:f.traditional,
				success:function(a)
				{
					$(f.target).html(a);
					if(f.successFn!="")
						f.successFn(f.params);
				},
				error:function(a,b,c)
				{
					ajaxExceptionMessage(a.status, b, c);
				},
				complete:function(a,b)
				{
					if(f.completeFn!="")
						f.completeFn(b);
					if(e)
						e.notifyTaskDone();
				}
			});
		}
	},
	runHtmlExt:function(d,e)
	{
		with(this)
		{
			var f=$.extend({target:"",
							url:"",
							data:"",
							successFn:"",
							completeFn:"",
							errorFn:"",
							type:"POST",
							traditional:true,
							params:""},
							d);
			if(f.target=="")
				return;
			if(f.url=="")
				return;
			run({url:f.url,
				dataType:"html",
				data:f.data,
				type:f.type,
				traditional:f.traditional,
				success:function(a)
				{
					$(f.target).html(a);
					if(f.successFn!="")
						f.successFn(f.params);
				},
				error:function(jqXhr, status, message)
				{
					if(f.errorFn!="")
						f.errorFn(jqXhr, status, f.data);
					else
						ajaxExceptionMessage(jqXhr, status, message);
				},
				complete:function(a,b)
				{
					if(f.completeFn!="")
						f.completeFn(b);
					if(e)
						e.notifyTaskDone();
				}
			});
		}
	},		
	runJson:function(d,e)
	{
		with(this)
		{
			var f=$.extend({target:"",
							url:"",
							data:"",
							successFn:"",
							completeFn:"",
							type:"POST",
							traditional:true},
							d);
			if(f.url=="")
				return;
			run({url:f.url,
				data:f.data,
				type:f.type,
				traditional:f.traditional,
				dataType:"json",
				success:function(a)
				{
					if(f.successFn!="")
						f.successFn(a);
				},
				error:function(jqXhr, status, message)
				{
					ajaxExceptionMessage(jqXhr, status, message);
				},
				complete:function(a,b)
				{
					if(f.completeFn!="")
						f.completeFn(b);
					if(e)
						e.notifyTaskDone();
				}
			});
		}
	},
	runJsonExt:function(d,e)
	{
		with(this)
		{
			var f=$.extend({target:"",
							url:"",
							data:"",
							successFn:"",
							completeFn:"",
							errorFn:"",
							type:"POST",
							traditional:true},
							d);
			if(f.url=="")
				return;
			run({url:f.url,
				data:f.data,
				type:f.type,
				traditional:f.traditional,
				dataType:"json",
				success:function(a)
				{
					if(f.successFn!="")
						f.successFn(a);
				},
				error:function(jqXhr, status, message)
				{
					if(f.errorFn!="")
						f.errorFn(jqXhr, status, message);
					else
						ajaxExceptionMessage(jqXhr, status, message);					
				},
				complete:function(a,b)
				{
					if(f.completeFn!="")
						f.completeFn(b);
					if(e)
						e.notifyTaskDone();
				}
			});
		}
	},	
	_addId:function(a)
	{
		FlowitUtil.log('_addId, id: '+a);
		if(!a)
			return;
		this.idsInQueue.push(a);
		FlowitUtil.log('_addId, idsInQueue: '+this.idsInQueue+'; length: '+this.idsInQueue.length);
	},
	_removeId:function(a)
	{
		with(this)
		{
			FlowitUtil.log('_removeId, id: '+a);
			for(var i=0;i<idsInQueue.length;i++)
			{
				if(idsInQueue[i]===a)
				{
					FlowitUtil.log('index: '+i);
					idsInQueue.splice(i,1);
					FlowitUtil.log('_removeId, idsInQueue: %s, length: %s',idsInQueue,idsInQueue.length);
					break;
				}
			}
		}
	},
	_initLoadingBar:function()
	{
		$.fn.nimbleLoader.setSettings({loaderClass:"loading_bar",debug:true,speed:'fast'});
	},
	_showLoader:function(a)
	{
		$('body').nimbleLoader(a?'show':'hide');
	}
});

var PageNavigator=Class.create
({
	initialize:function(a)
	{
		var b=$.extend({pageNaviSelector:".pageNavigator",
						pageRowCountCbxSelector:".pageRowCountCbx",
						pageNaviCssClass:"pageNavigator",
						pageRowCountCbxCssClass:"pageRowCountCbx",
						rowCountPerPage:20,
						pageCountPerGroup:10,
						currentPage:1,
						rowTotal:0,
						availableRowCountsPerPage:[10,20,30,40,50]},
						a);
		this.pageNaviSelector=b.pageNaviSelector;
		this.pageRowCountCbxSelector=b.pageRowCountCbxSelector;
		this.pageNaviCssClass=b.pageNaviCssClass;
		this.pageRowCountCbxCssClass=b.pageRowCountCbxCssClass;
		this.rowCountPerPage=b.rowCountPerPage;
		this.pageCountPerGroup=b.pageCountPerGroup;
		this.currentPage=b.currentPage;
		this.rowTotal=b.rowTotal;
		this.availableRowCountsPerPage=b.availableRowCountsPerPage;
		this.changeCallback=function()
		{
			FlowitUtil.log("changeCallback not registered.");
		};
	},
	prev:function()
	{
		this.goTo(this.currentPage-1);
	},
	next:function()
	{
		this.goTo(this.currentPage+1);
	},
	first:function()
	{
		this.goTo(1);
	},
	last:function()
	{
		this.goTo(this.getLastPage());
	},
	lastOfPrevGroup:function()
	{
		var a=this.getLastPageOfPrevGroup();
		if(a==-1)
			return;this.goTo(a);
	},
	firstOfNextGroup:function()
	{
		var a=this.getFirstPageOfNextGroup();
		if(a==-1)
			return;
		this.goTo(a);
	},
	goTo:function(a)
	{
		if(isNaN(a)||a<1||a>this.getLastPage())
			return;
		var b=this.currentPage;
		this.currentPage=a;
		var c=this.getFirstRowOfCurrentPage();
		var d=this.getLastRowOfCurrentPage();
		if(c==-1|d==-1)
		{
			this.currentPage=b;
			return;
		}
		this.changeCallback(c,d);
		this._updatePageNaviHtml();
	},
	updateRowCount:function(a)
	{
		var num = a.replace(VAR_ETC_LISTCOUNT,'');
		//this.rowCountPerPage=isNaN(num) ? this.getRowTotal() : num;
		this.rowCountPerPage=isNaN(num) ? 0 : num;
		
//		console.log(this.rowCountPerPage);
		var b=this.currentPage;
		this.currentPage=1;
		var c=this.getFirstRowOfCurrentPage();
		var d=this.getLastRowOfCurrentPage();
		if(c==-1|d==-1)
		{
			this.currentPage=b;
			return;
		}
		this.changeCallback(c,d);
		this._updatePageNaviHtml();
	},
	getCurrentPage:function()
	{
		return this.currentPage;
	},
	getLastPage:function()
	{
		if(this.rowTotal==0)
			return 1;
		
		var rowCount=this.rowCountPerPage;
		if(this.rowCountPerPage==0)
			rowCount=this.getRowTotal();
			
		var a=Math.ceil(this.rowTotal/rowCount);
		return a;
	},
	getLastPageOfPrevGroup:function()
	{
		var a=this.currentPage-this.pageCountPerGroup;
		if(a<1)
			return-1;
		var b=a%this.pageCountPerGroup;
		if(b===0)
			b=this.pageCountPerGroup;
		return a+this.pageCountPerGroup-b;
	},
	getFirstPageOfNextGroup:function()
	{
		var a=parseInt(this.currentPage)+this.pageCountPerGroup;
//		console.log("this.currentPage : ", this.currentPage);
//		console.log("this.pageCountPerGroup : ", this.pageCountPerGroup);
//		console.log("sum : ", a);
		if(a>this.getLastPage())
			return-1;
		var b=a%this.pageCountPerGroup;
		if(b===0)
			b=this.pageCountPerGroup;
		return a-b+1;
	},
	getFirstPageOfCurrentGroup:function()
	{
		return(Math.ceil(this.currentPage/this.pageCountPerGroup)-1)*this.pageCountPerGroup+1;
	},
	getLastPageOfCurrentGroup:function()
	{
		var a=Math.ceil(this.currentPage/this.pageCountPerGroup)*this.pageCountPerGroup;
		var b=this.getLastPage();
		return a>b?b:a;
	},
	getFirstRowOfCurrentPage:function()
	{
		if(this.rowTotal==0)
			return-1;
		
		var rowCount=this.rowCountPerPage;
		if(this.rowCountPerPage==0)
			rowCount=this.getRowTotal();

		return(this.currentPage-1)*rowCount;
	},
	getLastRowOfCurrentPage:function()
	{
		var rowCount=this.rowCountPerPage;
		if(this.rowCountPerPage==0)
			rowCount=this.getRowTotal();
		
		var a=this.currentPage*rowCount-1;
		return a>(this.rowTotal-1)?this.rowTotal-1:a;
	},
	refresh:function()
	{
		this._updatePageNaviHtml();
		this._updatePageRowCountCbxHtml();
	},
	updateRowTotal:function(a,b,c)
	{
		this.rowTotal=a;
		if(null!=c)
		{
			this.currentPage=c;
		}
		else
		{
			this.currentPage=1;
		}		
		if(b)
			this.refresh();
	},
	onChange:function(a)
	{
		this.changeCallback=a;
	},
	getRowTotal:function()
	{
		return this.rowTotal;
	},
	_updatePageNaviHtml:function()
	{
		var a=[];
		a.push('<a href="#"><span style="display:none;">'+1+'</span><img src="imgs/common/btn_firstBoard.gif" alt="'+ VAR_ETC_FIRST +'" /></a>');
		a.push('<a href="#"><span style="display:none;">'+this.getLastPageOfPrevGroup()+'</span><img src="imgs/common/btn_preBoard.gif" alt="'+ VAR_ETC_PRE +'" /></a>');
		a.push('<span>');
		var b=this.getLastPageOfCurrentGroup();
		for(var i=this.getFirstPageOfCurrentGroup();i<=b;i++)
		{
			if(i==this.currentPage)
				a.push('<strong>'+i+'</strong>');
			else 
				a.push('<a href="#">'+i+'</a>');
		}
		a.push('</span>');
		a.push('<a href="#"><span style="display:none;">'+this.getFirstPageOfNextGroup()+'</span><img src="imgs/common/btn_nextBoard.gif" alt="'+ VAR_ETC_NEXT +'" /></a>');
		a.push('<a href="#"><span style="display:none;">'+this.getLastPage()+'</span><img src="imgs/common/btn_lastBoard.gif" alt="'+ VAR_ETC_LAST +'" /></a>');
		var c=a.join('');
		$(this.pageNaviSelector).empty().addClass(this.pageNaviCssClass).html(c);
		this._registerPageNaviEvents();
	},
	_updatePageRowCountCbxHtml:function()
	{
		var a=[];
		var allCheckedKey = this.rowCountPerPage;
//		if (allCheckedKey != "10" && allCheckedKey != "20" && 
//				allCheckedKey != "30" && allCheckedKey != "40" && allCheckedKey != "50")
		if(allCheckedKey == 0)
		{			
			a.push('<p class="selected">');
			a.push('<span>' + VAR_ETC_ALL + '</span><a href="#"><img class="cur_pointer" src="imgs/common/btn_select_off.gif" alt="'+ VAR_ETC_LISTOPEN +'" /></a>');
			a.push('</p>');
			a.push('<ul>');
		}
		else
		{
			a.push('<p class="selected">');
			a.push('<span>',this.rowCountPerPage,VAR_ETC_LISTCOUNT,'</span><a href="#"><img class="cur_pointer" src="imgs/common/btn_select_off.gif" alt="'+ VAR_ETC_LISTOPEN +'" /></a>');
			a.push('</p>');
			a.push('<ul>');
		}		
		$.each(this.availableRowCountsPerPage,function(i,v){a.push('<li><span>',v,VAR_ETC_LISTCOUNT,'</span></li>');});
		a.push('<li><span>'+ VAR_ETC_ALL +'</span></li>');
		a.push('</ul>');
		var b=a.join('');
		$(this.pageRowCountCbxSelector).empty().addClass(this.pageRowCountCbxCssClass).html(b);
		this._applyRowCountCbxCss();this._registerPageRowCountCbxEvents();
	},
	_applyRowCountCbxCss:function()
	{
		$(this.pageRowCountCbxSelector).width($(this.pageRowCountCbxSelector+' ul').width());
	},
	_registerPageNaviEvents:function()
	{
		var b=this;
		$(this.pageNaviSelector).find('a').click(function(e)
		{
			e.preventDefault();
			var a=$(this).text();
			
			if(a==-1)
				return;
			b.goTo(a);
		});
	},
	_registerPageRowCountCbxEvents:function()
	{
		var c=this;$(this.pageRowCountCbxSelector+' .selected a').click(function(e)
		{
			e.preventDefault();
			var a=$(this).parents('.'+c.pageRowCountCbxCssClass);
			if(a.find('ul').is(':hidden'))
			{
				//over($(this));
				a.find('ul').fadeIn(function()
				{
					$(this).css('z-index',1);
				});
			}
			else
				
			{
				//out($(this));
				a.find('ul').fadeOut(function(){$(this).css('z-index',-1);});
			}
		}).blur(function(e)
		{
			var a=$(this).parents('.'+c.pageRowCountCbxCssClass);
			if(a.find('ul').is(':visible'))
			{
				$(this).trigger('click');
			}
		});
		$(this.pageRowCountCbxSelector+' .selected span').click(function(e)
		{
			$(this).nextAll('a').trigger('click').focus();
		});
		$(this.pageRowCountCbxSelector+' ul li').click(function(e)
		{
			var a=$(this).find('span').text();
			var b=$(this).parents('.'+c.pageRowCountCbxCssClass);
			b.find('.selected a').trigger('click');
			b.find('.selected span').text(a);
			FlowitUtil.log("Row count changed: %s",a);
			c.updateRowCount(a);
		});
	}
});